<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>空港フライト検索</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        select, button {
            padding: 10px;
            margin: 5px 0 10px;
            width: 100%;
            max-width: 300px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .flight {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>空港フライト検索</h1>
    <form id="flight-search-form">
        <label for="airport">空港コードを選択:</label>
        <select id="airport" required>
            <option value="ITM">大阪伊丹空港 (ITM/RJOO)</option>
        </select>

        <label for="type">種類を選択:</label>
        <select id="type" required>
            <option value="departure">出発</option>
            <option value="arrival">到着</option>
        </select>
        
        <button type="submit">検索</button>
    </form>
    <div id="results"></div>

    <script>
        document.getElementById('flight-search-form').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const airport = document.getElementById('airport').value;
            const type = document.getElementById('type').value;
            const resultsDiv = document.getElementById('results');

            resultsDiv.innerHTML = '検索中...';

            const endpoint = `https://opensky-network.org/api/flights/${type}?airport=${airport}`;

            fetch(endpoint)
                .then(response => response.json())
                .then(data => {
                    resultsDiv.innerHTML = '';
                    if (data.length > 0) {
                        data.forEach(flight => {
                            const flightDiv = document.createElement('div');
                            flightDiv.className = 'flight';
                            flightDiv.innerHTML = `
                                <p><strong>航空会社:</strong> ${flight.callsign}</p>
                                <p><strong>便名:</strong> ${flight.icao24}</p>
                                <p><strong>${type === 'departure' ? '出発時刻' : '到着時刻'}:</strong> ${new Date(flight.firstSeen * 1000).toLocaleString()}</p>
                                <p><strong>${type === 'departure' ? '到着地' : '出発地'}:</strong> ${type === 'departure' ? flight.estArrivalAirport : flight.estDepartureAirport}</p>
                            `;
                            resultsDiv.appendChild(flightDiv);
                        });
                    } else {
                        resultsDiv.innerHTML = '便が見つかりませんでした。';
                    }
                })
                .catch(error => {
                    console.error('Error fetching flight data:', error);
                    resultsDiv.innerHTML = 'エラーが発生しました。もう一度お試しください。';
                });
        });
    </script>
</body>
</html>
